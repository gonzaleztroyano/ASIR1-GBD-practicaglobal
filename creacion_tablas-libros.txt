
DROP DATABASE IF EXISTS LIBROS;
    CREATE DATABASE LIBROS;
    USE LIBROS;
    CREATE TABLE CLIENTES (
    DNI_CLI VARCHAR(10) PRIMARY KEY,
    SOCIO_DESDE DATE NOT NULL,
    EMAIL VARCHAR(50) NOT NULL,
    APELLIDOS VARCHAR(50),
    NOMBRE VARCHAR(50)
    );

CREATE TABLE AUTORES (
    DNI VARCHAR(10) PRIMARY KEY,
    NOMBRE VARCHAR(25) NOT NULL,
    APELLIDOS VARCHAR(25) NOT NULL,
    NACIONALIDAD VARCHAR(25) NOT NULL
    );

CREATE TABLE LIBROS (
    ISBN CHAR(13) PRIMARY KEY,
    AUTOR VARCHAR(10) NOT NULL,
    TITULO VARCHAR(25) NOT NULL,
    RESUMEN VARCHAR(350),
    PVP DECIMAL(4,2) NOT NULL,
    F_PUBLICACION DATE,
    EDITORIAL VARCHAR(15) NOT NULL,
    N_PAGINAS INTEGER(4),
    FOREIGN KEY (AUTOR) REFERENCES AUTORES(DNI)
    );

CREATE TABLE TIENDAS (
    ID_OFI INTEGER(3) PRIMARY KEY,
    CIUDAD VARCHAR(15) NOT NULL,
    REGION VARCHAR(10) NOT NULL,
    VENTAS INTEGER(10)
    );


CREATE TABLE TRABAJADORES (
    ID_EMP INTEGER(3) PRIMARY KEY,
    NOMBRE VARCHAR(15) NOT NULL,
    APELLIDOS VARCHAR(10) NOT NULL,
    F_CONTRATO DATE NOT NULL,
    PUESTO VARCHAR(15) NOT NULL,
    VENTAS INTEGER(10) NOT NULL,
    OFICINA INTEGER(3) NOT NULL,
    FOREIGN KEY (OFICINA) REFERENCES TIENDAS (ID_OFI)
    );



CREATE TABLE PEDIDOS (
    N_PEDIDO INTEGER(3) PRIMARY KEY,
    CLIENTE VARCHAR(10) NOT NULL,
    VENDEDOR INTEGER(3) NOT NULL,
    LIBRO CHAR(13) NOT NULL,
    FECHA DATE NOT NULL, 
    IMPORTE DECIMAL(4,2) NOT NULL,
    FOREIGN KEY (CLIENTE) REFERENCES CLIENTES (DNI_CLI),
    FOREIGN KEY (VENDEDOR) REFERENCES TRABAJADORES (ID_EMP),
    FOREIGN KEY (LIBRO) REFERENCES LIBROS (ISBN)
    );

CREATE TABLE EVENTOS (
    ID_EVENTO INTEGER(5) PRIMARY KEY,
    FECHA DATE NOT NULL,
    AUTOR VARCHAR(10) NOT NULL,
    LUGAR INTEGER(3) NOT NULL,
    COSTE DECIMAL(6,2),
    FOREIGN KEY (AUTOR) REFERENCES AUTORES (DNI),
    FOREIGN KEY (LUGAR) REFERENCES TIENDAS (ID_OFI)
    );

CREATE TABLE ASISTENCIA (
    EVENTO INTEGER(5),
    CLIENTE VARCHAR(10),
    BUTACA INTEGER(2) NOT NULL,
    PRIMARY KEY (EVENTO, CLIENTE),
    FOREIGN KEY (EVENTO) REFERENCES EVENTOS (ID_EVENTO),
    FOREIGN KEY (CLIENTE) REFERENCES CLIENTES (DNI_CLI)
    );

